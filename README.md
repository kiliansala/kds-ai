# KDS-AI

![Status](https://img.shields.io/badge/Status-Experimental-yellow)
![AI-Readable](https://img.shields.io/badge/AI-Native-blue)

**KDS-AI** is a proof-of-concept Design System architecture optimized for **AI Agent consumption**. It establishes a strict, vendor-neutral contract between Design (Figma) and Code (Web Components), enabling automated synchronization via MCP agents.

## ðŸ¤– AI Agent Onboarding (Start Here)

If you are an AI Agent tasked with working on this repo, follow these instructions strictly:

### 1. Understanding the Source of Truth

- **Primary Contract**: `contracts/component-definitions.json`. ALL changes to API, props, or states MUST begin here.
- **Verification**: Run `npm run validate` to ensure your changes to the JSON match the schema (`contracts/component-contract.schema.json`).

### 2. File Structure

- `/contracts`: The brain of the system.
  - `component-definitions.json`: The data.
  - `mcp-workflow.md`: How to sync with Figma.
- `/src/components`: The implementation.
  - Native Web Components (Vanilla JS/TS).
  - Must `observe` attributes defined in the contract.
  - Must `dispatch` events defined in the contract.
- `/figma`: Configs for Figma Code Connect.

### 3. Workflow

1. **Read**: Check the contract for the component definition.
2. **Implement**: Create/Edit `src/components/kds-[name].ts`.
3. **Connect**: Update `figma/[name].connect.ts`.
4. **Validate**: Run `npm run validate`.
5. **Verify**: Run `npm run dev` and check the localhost playground.

## Development

```bash
# Install dependencies
npm install

# Start the dev-app playground
npm run dev

# Validate system integrity
npm run validate

# Sync tokens from Figma â†’ figma/
npm run tokens:sync

# Build consumable tokens artifact
npm run tokens:build

# Optional: watch figma/variables.*.json and rebuild
npm run tokens:watch

# Optional: publish CSS variables to src/styles/tokens.css
npm run tokens:css

```

## Token workflow (Figma as SSOT)

- Inputs: `figma/variables.primitive.json`, `figma/variables.semantic.json`, `figma/variables.components.json` (pulled via `npm run tokens:sync`).
- Build artifact: `src/tokens/tokens-data.json` (generated by `npm run tokens:build`), which includes `canonicalByKey` and `aliasToCanonical` (prioridad Primitive > Semantic > Components).
- Consumer: dev-app debe leer **solo** `src/tokens/tokens-data.json` (no lecturas directas de los JSON crudos).
- CSS variables: `npm run tokens:css` genera `src/styles/tokens.css` desde los mismos insumos.
- Naming (breaking change): CSS vars usan prefijo de nivel y puntos por jerarquÃ­a: `--kds-pri.<coleccion>.<ruta>`, `--kds-sem.<coleccion>.<ruta>`, `--kds-comp.<coleccion>.<ruta>`, donde `<coleccion>` es `collection.name` en Figma y `<ruta>` es `name` del token; ambos normalizados (minÃºsculas, `/` â†’ `.`, espacios â†’ `-`, limpieza de caracteres).

## MCP / Figma Code Connect

- Figma es la Single Source of Truth visual. MCP baja tokens y componentes, y Code Connect mapea props entre Figma y los web components.
- Contrato de componentes: `contracts/component-definitions.json` (punto de entrada para API/props/slots/events).
- Wrappers Angular/React/Blazor se generan desde los web components base (Lit) y deben seguir el contrato.
